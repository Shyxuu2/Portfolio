(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const e of r)if(e.type==="childList")for(const d of e.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function n(r){const e={};return r.integrity&&(e.integrity=r.integrity),r.referrerPolicy&&(e.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?e.credentials="include":r.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(r){if(r.ep)return;r.ep=!0;const e=n(r);fetch(r.href,e)}})();const f=[{code:"§0",name:"black",fhex:"#000000"},{code:"§1",name:"dark_blue",fhex:"#0000AA"},{code:"§2",name:"dark_green",fhex:"#00AA00"},{code:"§3",name:"dark_aqua",fhex:"#00AAAA"},{code:"§4",name:"dark_red",fhex:"#AA0000"},{code:"§5",name:"dark_purple",fhex:"#AA00AA"},{code:"§6",name:"gold",fhex:"#FFAA00"},{code:"§7",name:"gray",fhex:"#AAAAAA"},{code:"§8",name:"dark_gray",fhex:"#555555"},{code:"§9",name:"blue",fhex:"#5555FF"},{code:"§a",name:"green",fhex:"#55FF55"},{code:"§b",name:"aqua",fhex:"#55FFFF"},{code:"§c",name:"red",fhex:"#FF5555"},{code:"§d",name:"light_purple",fhex:"#FF55FF"},{code:"§e",name:"yellow",fhex:"#FFFF55"},{code:"§f",name:"white",fhex:"#FFFFFF"}],C=[{code:"§k",name:"highlighted"},{code:"§l",name:"bold"},{code:"§m",name:"strikethrough"},{code:"§n",name:"underline"},{code:"§o",name:"italic"},{code:"§r",name:"reset"}],c={commands:{},commandToCode:{},reset:"§r",highlightColor:"#888888"},u={colorToPrefixMap:{},normalizedHighlightColor:""},p=o=>{if(!o||o==="transparent")return"";const t=document.createElement("div");t.style.color=o,document.body.appendChild(t);const n=getComputedStyle(t).color;return document.body.removeChild(t),n};function v(){b(),E(),L(),w(),u.normalizedHighlightColor=p(c.highlightColor);const o=document.getElementById("color-dropdown-menu");o&&(o.style.maxHeight="0",o.style.overflow="hidden")}function b(){const o={highlighted:"backColor",bold:"bold",strikethrough:"strikethrough",underline:"underline",italic:"italic"};C.forEach(t=>{if(t.name==="reset"){c.reset=t.code;return}const n=o[t.name];n&&(c.commands[t.code]={command:n,value:n==="backColor"?c.highlightColor:null,name:t.name},c.commandToCode[n]=t.code)}),f.forEach(t=>{c.commands[t.code]={command:"foreColor",value:t.fhex,name:t.name}})}function E(){const o=document.getElementById("color-dropdown-menu");if(!o)return;o.innerHTML="";const t=(a,r)=>{const e=document.createElement("div");e.className="relative group flex justify-center";const d=document.createElement("button");d.className="size-7 rounded-full border-2 border-semi-transparent hover:border-sky-400 transition-all",d.style.backgroundColor=a.fhex,d.dataset.command="foreColor",d.dataset.value=a.fhex;const i=document.createElement("span");return i.textContent=`${a.name} (${a.code})`,i.className=`tooltip
            absolute top-full mt-3 px-2 py-1
            bg-slate-700 text-white text-sm rounded-md
            whitespace-nowrap
            invisible opacity-0 scale-95
            transition-all
            group-hover:visible group-hover:opacity-100 group-hover:scale-100
            pointer-events-none
        `,e.appendChild(i),e.appendChild(d),e},n=()=>{const a=document.createElement("div");a.className="relative group flex justify-center";const r=document.createElement("button");r.className="checkerboard-button checkerboard",r.dataset.command="resetFormatting";const e=document.createElement("span");return e.textContent="Reset (§r)",e.className=`tooltip
            absolute top-full mt-3 px-2 py-1
            bg-slate-700 text-white text-sm rounded-md
            whitespace-nowrap
            invisible opacity-0 scale-95
            transition-all
            group-hover:visible group-hover:opacity-100 group-hover:scale-100
            pointer-events-none
        `,a.appendChild(e),a.appendChild(r),a};f.forEach((a,r)=>{o.appendChild(t(a))}),o.appendChild(n())}function L(){for(const o of f)u.colorToPrefixMap[p(o.fhex)]=o.code}function y(o){const t=document.getElementById("notification");t.textContent=o,t.classList.remove("opacity-0"),t.classList.add("opacity-100"),setTimeout(()=>{t.classList.remove("opacity-100"),t.classList.add("opacity-0")},2e3)}function w(){const o=document.getElementById("toolbar"),t=document.getElementById("editor"),n=document.getElementById("export-btn"),a=document.getElementById("copy-export-btn"),r=document.getElementById("color-dropdown-btn"),e=document.getElementById("color-dropdown-menu");a.addEventListener("click",()=>{const i=document.getElementById("export-output").textContent;navigator.clipboard.writeText(i).then(()=>{y("Copié dans le presse papier !")}).catch(s=>{console.error("Erreur lors de la copie : ",s),alert("Impossible de copier. Copie manuelle requise.")})}),o.addEventListener("click",g),n.addEventListener("click",k),t.addEventListener("keyup",m),t.addEventListener("mouseup",m),t.addEventListener("selectionchange",m),r.addEventListener("click",i=>{i.stopPropagation(),e.dataset.state==="closed"?(e.dataset.state="open",e.classList.remove("overflow-hidden"),e.classList.add("max-h-96","p-2","mt-2"),e.style.maxHeight="24rem",e.style.transitionDuration="500ms",console.log("Opening dropdown. MaxHeight:",e.style.maxHeight,"Overflow:",e.style.overflow,"Padding:",getComputedStyle(e).padding,"Margin:",getComputedStyle(e).margin)):(e.dataset.state="closed",e.classList.remove("p-2","mt-2"),e.style.maxHeight="0",e.style.transitionDuration="200ms",e.addEventListener("transitionend",function s(){e.classList.add("overflow-hidden"),e.removeEventListener("transitionend",s)}))}),e.addEventListener("click",i=>{g(i),e.dataset.state="closed",e.classList.remove("p-2","mt-2"),e.style.maxHeight="0",e.style.transitionDuration="200ms",e.addEventListener("transitionend",function s(){e.classList.add("overflow-hidden"),e.removeEventListener("transitionend",s)})}),window.addEventListener("click",i=>{!r.contains(i.target)&&!e.contains(i.target)&&(e.dataset.state="closed",e.classList.remove("p-2","mt-2"),e.style.maxHeight="0",e.style.transitionDuration="200ms",e.addEventListener("transitionend",function s(){e.classList.add("overflow-hidden"),e.removeEventListener("transitionend",s)}))}),!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||document.querySelectorAll(".tooltip").forEach(s=>{s.style.display="none"})}function g(o){const t=o.target.closest("button");if(!t)return;const{command:n,value:a}=t.dataset;if(n){if(o.preventDefault(),document.getElementById("editor").focus(),n==="resetFormatting")document.execCommand("removeFormat",!1,null),document.execCommand("backColor",!1,"transparent");else if(n==="backColor"){const r=t.classList.contains("bg-slate-700");document.execCommand("backColor",!1,r?"transparent":c.highlightColor)}else document.execCommand(n,!1,a||null);m()}}function k(){const o=document.getElementById("editor"),t=document.getElementById("export-btn"),n=B(o),a=n.replace(/§/g,"§").replace(/\n/g,`
`),r=document.getElementById("export-container"),e=document.getElementById("export-output");if(r.dataset.standard=n,r.dataset.motd=a,r.dataset.current="standard",e.textContent=n,r.classList.remove("hidden"),document.getElementById("editor").classList.remove("rounded-b-xl"),!navigator.clipboard){console.error("Clipboard API not available.");return}navigator.clipboard.writeText(n).then(()=>{y("Copié automatiquement dans le presse papier !");const i=t.innerHTML;t.innerHTML=`
        <i class="fa-solid fa-check"></i> 
        Copié!`,setTimeout(()=>{t.innerHTML=i},2e3)}).catch(i=>{console.error("Failed to copy text: ",i),alert("Failed to copy text. Please copy it manually from the box below.")})}editor.addEventListener("paste",o=>{o.preventDefault();const t=(o.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,t)});document.getElementById("toggle-standard").addEventListener("click",()=>{const o=document.getElementById("export-container"),t=document.getElementById("export-output");t.textContent=o.dataset.standard,o.dataset.current="standard"});document.getElementById("toggle-motd").addEventListener("click",()=>{const o=document.getElementById("export-container"),t=document.getElementById("export-output");t.textContent=o.dataset.motd,o.dataset.current="motd"});function m(){Object.keys(c.commandToCode).forEach(o=>{const t=document.querySelector(`[data-command="${o}"]`);if(t){let n=!1;if(o==="backColor"){const a=document.queryCommandValue(o);n=p(a)===u.normalizedHighlightColor}else n=document.queryCommandState(o);t.classList.toggle("bg-slate-700",n),t.classList.toggle("text-sky-400",n)}})}let l={output:"",activePrefixes:new Set};function B(o){l={output:"",activePrefixes:new Set};for(const t of o.childNodes)x(t);return l.output.startsWith(c.reset)&&l.output.length===c.reset.length?"":l.output}function x(o){if(o.nodeType===Node.TEXT_NODE){if(o.textContent.trim()==="")return;const n=o.textContent;let a=l.activePrefixes;h(o.parentElement);for(const r of n){const e=h(o.parentElement),d=new Set([...e].filter(s=>!a.has(s)));new Set([...a].filter(s=>!e.has(s))).size>0?l.output+=c.reset+Array.from(e).sort().join(""):d.size>0&&(l.output+=Array.from(d).sort().join("")),l.output+=r,a=new Set(e)}l.activePrefixes=a;return}if(o.nodeType!==Node.ELEMENT_NODE)return;getComputedStyle(o).display==="block"&&l.output.length>0&&!l.output.endsWith(`
`)&&(l.output+=`
`),o.tagName==="BR"&&(l.output.endsWith(`
`)||(l.output+=`
`));for(const n of o.childNodes)x(n)}function h(o){const t=new Set;let n=o;for(;n&&n.nodeType===Node.ELEMENT_NODE;){const a=getComputedStyle(n),r=a.getPropertyValue("font-weight");(r==="bold"||parseInt(r)>=700)&&t.add(c.commandToCode.bold),a.getPropertyValue("font-style")==="italic"&&t.add(c.commandToCode.italic);const e=a.getPropertyValue("text-decoration-line")?.toLowerCase()||"",d=a.getPropertyValue("text-decoration")?.toLowerCase()||"",i=(e+" "+d).split(/\s+/);i.includes("underline")&&t.add(c.commandToCode.underline),i.includes("line-through")&&t.add(c.commandToCode.strikethrough);const s=a.getPropertyValue("color");(n.style.color||n.getAttribute("color")||n.classList?.length>0)&&u.colorToPrefixMap[s]&&t.add(u.colorToPrefixMap[s]),p(n.style.backgroundColor)===u.normalizedHighlightColor&&t.add(c.commandToCode.backColor),n=n.parentElement}return t}document.addEventListener("DOMContentLoaded",v);
