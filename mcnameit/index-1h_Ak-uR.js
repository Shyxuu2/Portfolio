(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const f=[{code:"§0",name:"black",fhex:"#000000"},{code:"§1",name:"dark_blue",fhex:"#0000AA"},{code:"§2",name:"dark_green",fhex:"#00AA00"},{code:"§3",name:"dark_aqua",fhex:"#00AAAA"},{code:"§4",name:"dark_red",fhex:"#AA0000"},{code:"§5",name:"dark_purple",fhex:"#AA00AA"},{code:"§6",name:"gold",fhex:"#FFAA00"},{code:"§7",name:"gray",fhex:"#AAAAAA"},{code:"§8",name:"dark_gray",fhex:"#555555"},{code:"§9",name:"blue",fhex:"#5555FF"},{code:"§a",name:"green",fhex:"#55FF55"},{code:"§b",name:"aqua",fhex:"#55FFFF"},{code:"§c",name:"red",fhex:"#FF5555"},{code:"§d",name:"light_purple",fhex:"#FF55FF"},{code:"§e",name:"yellow",fhex:"#FFFF55"},{code:"§f",name:"white",fhex:"#FFFFFF"}],y=[{code:"§k",name:"highlighted"},{code:"§l",name:"bold"},{code:"§m",name:"strikethrough"},{code:"§n",name:"underline"},{code:"§o",name:"italic"},{code:"§r",name:"reset"}],c={commands:{},commandToCode:{},reset:"§r",highlightColor:"#888888"},u={colorToPrefixMap:{},normalizedHighlightColor:""},p=t=>{if(!t||t==="transparent")return"";const e=document.createElement("div");e.style.color=t,document.body.appendChild(e);const o=getComputedStyle(e).color;return document.body.removeChild(e),o};function C(){b(),v(),E(),k(),u.normalizedHighlightColor=p(c.highlightColor)}function b(){const t={highlighted:"backColor",bold:"bold",strikethrough:"strikethrough",underline:"underline",italic:"italic"};y.forEach(e=>{if(e.name==="reset"){c.reset=e.code;return}const o=t[e.name];o&&(c.commands[e.code]={command:o,value:o==="backColor"?c.highlightColor:null,name:e.name},c.commandToCode[o]=e.code)}),f.forEach(e=>{c.commands[e.code]={command:"foreColor",value:e.fhex,name:e.name}})}function v(){const t=document.getElementById("color-buttons-container");if(!t)return;t.innerHTML="";for(const n of f){const r=document.createElement("div");r.className="relative group flex justify-center";const i=document.createElement("button");i.className="size-7 rounded-full border-2 border-semi-transparent hover:border-sky-400 transition-all ",i.style.backgroundColor=n.fhex,i.dataset.command="foreColor",i.dataset.value=n.fhex;const l=document.createElement("span");l.textContent=`${n.name} (${n.code})`,l.className=`
            absolute top-full mt-3 px-2 py-1             
            bg-slate-800 text-white text-sm rounded-md   
            whitespace-nowrap                               
            invisible opacity-0 scale-95                    
            transition-all                                  
            group-hover:visible group-hover:opacity-100 group-hover:scale-100
            pointer-events-none                             
        `,n.code==="§0"&&(l.style.transform="translateX(20px)"),r.appendChild(i),r.appendChild(l),t.appendChild(r)}const e=document.createElement("div");e.className="relative group flex justify-center";const o=document.createElement("button");o.className="checkerboard-button checkerboard",o.dataset.command="resetFormatting";const a=document.createElement("span");a.textContent="Reset (§r)",a.className=`
        absolute top-full mt-3 px-2 py-1             
        bg-slate-800 text-white text-sm rounded-md   
        whitespace-nowrap                               
        invisible opacity-0 scale-95                    
        transition-all                                  
        group-hover:visible group-hover:opacity-100 group-hover:scale-100
        pointer-events-none                             
    `,e.appendChild(o),e.appendChild(a),t.appendChild(e)}function E(){for(const t of f)u.colorToPrefixMap[p(t.fhex)]=t.code}function g(t){const e=document.getElementById("notification");e.textContent=t,e.classList.remove("opacity-0"),e.classList.add("opacity-100"),setTimeout(()=>{e.classList.remove("opacity-100"),e.classList.add("opacity-0")},2e3)}function k(){const t=document.getElementById("toolbar"),e=document.getElementById("editor"),o=document.getElementById("export-btn");document.getElementById("copy-export-btn").addEventListener("click",()=>{const n=document.getElementById("export-output").textContent;navigator.clipboard.writeText(n).then(()=>{g("Copié dans le presse papier !")}).catch(r=>{console.error("Erreur lors de la copie : ",r),alert("Impossible de copier. Copie manuelle requise.")})}),t.addEventListener("click",L),o.addEventListener("click",w),e.addEventListener("keyup",m),e.addEventListener("mouseup",m),e.addEventListener("selectionchange",m)}function L(t){const e=t.target.closest("button");if(!e)return;const{command:o,value:a}=e.dataset;if(o){if(t.preventDefault(),document.getElementById("editor").focus(),o==="resetFormatting")document.execCommand("removeFormat",!1,null),document.execCommand("backColor",!1,"transparent");else if(o==="backColor"){const n=e.classList.contains("bg-slate-700");document.execCommand("backColor",!1,n?"transparent":c.highlightColor)}else document.execCommand(o,!1,a||null);m()}}function w(){const t=document.getElementById("editor"),e=document.getElementById("export-btn"),o=F(t),a=o.replace(/§/g,"\\u00a7").replace(/\n/g,"\\n"),n=document.getElementById("export-container"),r=document.getElementById("export-output");if(n.dataset.standard=o,n.dataset.motd=a,n.dataset.current="standard",r.textContent=o,n.classList.remove("hidden"),document.getElementById("editor").classList.remove("rounded-b-xl"),!navigator.clipboard){console.error("Clipboard API not available.");return}navigator.clipboard.writeText(o).then(()=>{g("Copié automatiquement dans le presse papier !");const l=e.innerHTML;e.innerHTML=`
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
        </svg> 
        Copié!`,setTimeout(()=>{e.innerHTML=l},2e3)}).catch(l=>{console.error("Failed to copy text: ",l),alert("Failed to copy text. Please copy it manually from the box below.")})}editor.addEventListener("paste",t=>{t.preventDefault();const e=(t.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,e)});document.getElementById("toggle-standard").addEventListener("click",()=>{const t=document.getElementById("export-container"),e=document.getElementById("export-output");e.textContent=t.dataset.standard,t.dataset.current="standard"});document.getElementById("toggle-motd").addEventListener("click",()=>{const t=document.getElementById("export-container"),e=document.getElementById("export-output");e.textContent=t.dataset.motd,t.dataset.current="motd"});function m(){Object.keys(c.commandToCode).forEach(t=>{const e=document.querySelector(`[data-command="${t}"]`);if(e){let o=!1;if(t==="backColor"){const a=document.queryCommandValue(t);o=p(a)===u.normalizedHighlightColor}else o=document.queryCommandState(t);e.classList.toggle("bg-slate-700",o),e.classList.toggle("text-sky-400",o)}})}let d={output:"",activePrefixes:new Set};function F(t){d={output:"",activePrefixes:new Set};for(const e of t.childNodes)x(e);return d.output.startsWith(c.reset)&&d.output.length===c.reset.length?"":d.output}function x(t){if(t.nodeType===Node.TEXT_NODE){if(t.textContent.trim()==="")return;const o=t.textContent;let a=d.activePrefixes;h(t.parentElement);for(const n of o){const r=h(t.parentElement),i=new Set([...r].filter(s=>!a.has(s)));new Set([...a].filter(s=>!r.has(s))).size>0?d.output+=c.reset+Array.from(r).sort().join(""):i.size>0&&(d.output+=Array.from(i).sort().join("")),d.output+=n,a=new Set(r)}d.activePrefixes=a;return}if(t.nodeType!==Node.ELEMENT_NODE)return;getComputedStyle(t).display==="block"&&d.output.length>0&&!d.output.endsWith(`
`)&&(d.output+=`
`),t.tagName==="BR"&&(d.output.endsWith(`
`)||(d.output+=`
`));for(const o of t.childNodes)x(o)}function h(t){const e=new Set;let o=t;for(;o&&o.nodeType===Node.ELEMENT_NODE;){const a=getComputedStyle(o),n=a.getPropertyValue("font-weight");(n==="bold"||parseInt(n)>=700)&&e.add(c.commandToCode.bold),a.getPropertyValue("font-style")==="italic"&&e.add(c.commandToCode.italic);const r=a.getPropertyValue("text-decoration-line")?.toLowerCase()||"",i=a.getPropertyValue("text-decoration")?.toLowerCase()||"",l=(r+" "+i).split(/\s+/);l.includes("underline")&&e.add(c.commandToCode.underline),l.includes("line-through")&&e.add(c.commandToCode.strikethrough);const s=a.getPropertyValue("color");(o.style.color||o.getAttribute("color")||o.classList?.length>0)&&u.colorToPrefixMap[s]&&e.add(u.colorToPrefixMap[s]),p(o.style.backgroundColor)===u.normalizedHighlightColor&&e.add(c.commandToCode.backColor),o=o.parentElement}return e}document.addEventListener("DOMContentLoaded",C);
